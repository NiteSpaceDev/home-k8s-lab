# https://taskfile.dev

version: '3'

tasks:
  all:
    desc: Apply config to Cluster
    run: once
    silent: false
    deps:
      - ohm
      - tsu
      - sumu

  ohm:
    desc: Config ohm-talos
    dir: ../opilab
    vars:
      NAME: ohm-talos
      IP: 192.168.5.10
    cmds:
      - talosctl apply -n {{.IP}} -f opilab-{{.NAME}}.yaml {{.SECURE}}

  tsu:
    desc: Config Tsukuru vm
    dir: ../opilab
    vars:
      NAME: olabtsuvm
      IP: 192.168.5.15
    cmds:
      - talosctl apply -n {{.IP}} -f opilab-{{.NAME}}.yaml {{.SECURE}}

  sumu:
    desc: Config Sumu VM
    dir: ../opilab
    vars:
      NAME: olabsumuvm
      IP: 192.168.5.16
    cmds:
      - talosctl apply -n {{.IP}} -f opilab-{{.NAME}}.yaml {{.SECURE}}
